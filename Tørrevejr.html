<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vejr til Tørretøj</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h2>Skal vasketøjet ud?</h2>
    <div id="weatherReport"></div>
    <script>
        var api_key = 'bb95120518eb14ab25ee3a89ad9769ec';

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var lat = position.coords.latitude;
                var lon = position.coords.longitude;
                var api_url = `https://api.weatherapi.com/v1/forecast.json?key=${api_key}&q=${lat},${lon}&days=7`;

                $.getJSON(api_url, function(data) {
                    console.log(data);  // For debugging purpose
                    var forecastDays = data.forecast.forecastday;

                    forecastDays.forEach(day => {
                        var dayName = new Date(day.date).toLocaleDateString('da-DK', { weekday: 'long' });
                        var dayIntervals = getGoodWeatherIntervals(day);

                        if(dayIntervals.length > 0){
                            $('#weatherReport').append('<p>' + dayName + ': ' + consolidateIntervals(dayIntervals).join(' og ') + ' (Gennemsnitlig luftfugtighed: ' + Math.round(averageHumidity(dayIntervals)) + '%).' + '</p>');
                        }
                    });

                    $('#weatherReport').append('<p>Din nuværende by er: ' + data.location.name + '.</p>');
                });
            });
        } else {
            console.log("Geolocation is not supported by this browser.");
        }

        // Remaining part of the JavaScript code
    </script>
</body>
</html>
